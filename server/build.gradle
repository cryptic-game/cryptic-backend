plugins {
    id 'application'
    id 'org.hibernate.orm'
}

dependencies {
    implementation(project(':java-base'))
    implementation(project(':java-data'))
    annotationProcessor("org.springframework:spring-context-indexer:5.3.7")
    annotationProcessor("org.springframework.boot:spring-boot-configuration-processor:2.4.5")
}

application {
    applicationName = 'server'
    mainClass.set('net.cryptic_game.backend.base.Bootstrap')
    applicationDefaultJvmArgs = ["-XX:+UseParallelGC"]
}

task start(type: JavaExec) {
    dependsOn installDist
    classpath fileTree("${buildDir}/install/server/lib").matching { "*.jar" }.files
    main "net.cryptic_game.backend.base.Bootstrap"
    workingDir file(projectDir)
}

hibernate {
    enhance {
        enableLazyInitialization = true
        enableDirtyTracking = true
        enableAssociationManagement = true
        enableExtendedEnhancement = false
    }
}
